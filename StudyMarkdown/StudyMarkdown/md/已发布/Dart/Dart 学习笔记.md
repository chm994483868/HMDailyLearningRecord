# Dart å­¦ä¹ ç¬”è®°

> &emsp;Dart æ˜¯è°·æ­Œå¼€å‘çš„è®¡ç®—æœºç¼–ç¨‹è¯­è¨€ï¼Œåæ¥è¢« Ecma (ECMA-408)è®¤å®šä¸ºæ ‡å‡†ã€‚å®ƒè¢«ç”¨äº webã€æœåŠ¡å™¨ã€ç§»åŠ¨åº”ç”¨ï¼ˆFlutterï¼‰ å’Œç‰©è”ç½‘ç­‰é¢†åŸŸçš„å¼€å‘ã€‚å®ƒæ˜¯å®½æ¾å¼€æºè®¸å¯è¯ï¼ˆä¿®æ”¹çš„ BSD è¯ä¹¦ï¼‰ä¸‹çš„å¼€æºè½¯ä»¶ã€‚(Web ç¼–ç¨‹è¯­è¨€ Dart)
>
> &emsp;Dart æ˜¯é¢å‘å¯¹è±¡çš„ã€ç±»å®šä¹‰çš„ã€å•ç»§æ‰¿çš„è¯­è¨€ã€‚å®ƒçš„è¯­æ³•ç±»ä¼¼ C è¯­è¨€ï¼Œå¯ä»¥è½¬è¯‘ä¸º JavaScriptï¼Œæ”¯æŒæ¥å£ï¼ˆinterfacesï¼‰ã€æ··å…¥ï¼ˆmixinsï¼‰ã€æŠ½è±¡ç±»ï¼ˆabstract classesï¼‰ã€å…·ä½“åŒ–æ³›å‹ï¼ˆreified genericsï¼‰ã€å¯é€‰ç±»å‹ï¼ˆoptional typingï¼‰å’Œ sound type systemï¼ˆsound null safetyï¼šDart ä¸­æ‰€æœ‰å˜é‡å¼•ç”¨çš„éƒ½æ˜¯ å¯¹è±¡ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æ˜¯ä¸€ä¸ªç±»çš„å®ä¾‹ã€‚æ•°å­—ã€å‡½æ•°ä»¥åŠ null éƒ½æ˜¯å¯¹è±¡ã€‚é™¤å» null ä»¥å¤–ï¼ˆå¦‚æœä½ å¼€å¯äº†ç©ºå®‰å…¨ï¼‰ï¼Œæ‰€æœ‰çš„ç±»éƒ½ç»§æ‰¿äº Object ç±»ï¼‰ã€‚
> 
> &emsp;Dart äº®ç›¸äº 2011 å¹´ 10 æœˆ 10 æ—¥è‡³ 12 æ—¥åœ¨ä¸¹éº¦å¥¥å°”èƒ¡æ–¯ä¸¾è¡Œçš„ GOTO å¤§ä¼šä¸Šã€‚è¯¥é¡¹ç›®ç”± Lars bak å’Œ kasper lund åˆ›å»ºã€‚
>
> &emsp;Ecma å›½é™…ç»„ç»‡ç»„å»ºäº†æŠ€æœ¯å§”å‘˜ä¼š TC52 æ¥å¼€å±• Dart çš„æ ‡å‡†åŒ–å·¥ä½œï¼Œå¹¶ä¸”åœ¨ **Dart å¯ä»¥ç¼–è¯‘ä¸ºæ ‡å‡† JavaScript** çš„æƒ…å†µä¸‹ï¼Œå®ƒå¯ä»¥åœ¨ä»»ä½•ç°ä»£æµè§ˆå™¨ä¸­æœ‰æ•ˆåœ°å·¥ä½œã€‚Ecma å›½é™…ç»„ç»‡äº 2014 å¹´ 7 æœˆç¬¬ 107 å±Šå¤§ä¼šæ‰¹å‡†äº† Dart è¯­è¨€è§„èŒƒç¬¬ä¸€ç‰ˆï¼Œå¹¶äº 2014 å¹´ 12 æœˆæ‰¹å‡†äº†ç¬¬äºŒç‰ˆã€‚
> 
> &emsp;2015 å¹´ 5 æœˆ Dart å¼€å‘è€…å³°ä¼šä¸Šï¼Œäº®ç›¸äº†åŸºäº Dart è¯­è¨€çš„ç§»åŠ¨åº”ç”¨ç¨‹åºå¼€å‘æ¡†æ¶ Skyï¼Œåæ›´åä¸º Flutterã€‚
>
> &emsp;2018 å¹´ 2 æœˆï¼ŒDart2 æˆä¸ºå¼ºç±»å‹è¯­è¨€ã€‚[DARTï¼ˆè®¡ç®—æœºç¼–ç¨‹è¯­è¨€ï¼‰--ç™¾åº¦ç™¾ç§‘](https://baike.baidu.com/item/DART/22500518?fr=aladdin)

&emsp;Dart å¼€å‘ç¯å¢ƒï¼š

+ [DartPad](https://dartpad.cn) æ˜¯ä¸€ä¸ªå¯ä»¥è®©ä½ åœ¨ä»»ä½•ç°ä»£åŒ–çš„æµè§ˆå™¨ä¸­ä½“éªŒ Dart ç¼–ç¨‹è¯­è¨€çº¿ä¸Šå·¥å…·ï¼Œå®ƒæ˜¯å¼€æºçš„ã€‚å³åœ¨ç½‘é¡µä¸Šå†™ Dartï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿˜æ˜¯é€‰æ‹© VSCode å§ï¼
+ ä½¿ç”¨ VS Code å®‰è£… Dart æ‰©å±•ï¼Œç„¶åæ–°å»ºä¸€ä¸ª .dart æ–‡ä»¶ç›´æ¥å¼€å§‹ Dart ç¼–ç¨‹ï¼ 

## main 

&emsp;æ¯ä¸ªåº”ç”¨éƒ½æœ‰ä¸€ä¸ª `main()` å‡½æ•°ã€‚å¯ä»¥ä½¿ç”¨é¡¶å±‚ï¼ˆtop-levelï¼‰å‡½æ•° `print()` æ¥å°†ä¸€æ®µæ–‡æœ¬è¾“å‡ºæ˜¾ç¤ºåˆ°æ§åˆ¶å°ï¼š

```dart
void main() {
  print('Hello, World!');
}
```

## å˜é‡

&emsp;è™½ç„¶ Dart æ˜¯ä»£ç ç±»å‹å®‰å…¨çš„è¯­è¨€ï¼Œä½†æ˜¯ç”±äºå…¶ **æ”¯æŒç±»å‹æ¨æ–­**ï¼Œå› æ­¤å¤§å¤šæ•°å˜é‡ä¸éœ€è¦æ˜¾å¼åœ°æŒ‡å®šç±»å‹ï¼š(ä»£ç ç±»å‹å®‰å…¨å’Œæ”¯æŒç±»å‹æ¨æ–­)

```dart
  var name = 'Voyager I';
  var year = 1977;
  var antennaDiameter = 3.7;
  var flybyObjects = ['Jupiter', 'Saturn', 'Uranus', 'Neptune'];
  var image = {
    'tags': ['saturn'],
    'url': '//path/to/saturn.jpg'
  };
  print(name);
  print(year);
  print(antennaDiameter);
  print(flybyObjects);
  print(image);
```

&emsp;åé¢æˆ‘ä»¬ä¼šå­¦ä¹ æ›´å¤š Dart ä¸­å˜é‡ç›¸å…³çš„çŸ¥è¯†ç‚¹ï¼ŒåŒ…æ‹¬å˜é‡çš„é»˜è®¤å€¼ï¼Œfinal å’Œ const å…³é”®å­—ä»¥åŠé™æ€ç±»å‹ç­‰ã€‚

## æµç¨‹æ§åˆ¶è¯­å¥

&emsp;å’Œå…¶å®ƒè¯­è¨€çš„æµç¨‹æ§åˆ¶è¯­å¥åŸºæœ¬ä¸€æ ·ã€‚

```dart
  if (year >= 2001) {
    print('21st century');
  } else if (year >= 1901) {
    print('20th century');
  }

  for (final object in flybyObjects) {
    print(object);
  }

  for (int month = 1; month <= 12; month++) {
    print(month);
  }

  while (year < 2016) {
    year += 1;
  }
```

## å‡½æ•°

&emsp;å»ºè®®ä¸ºæ¯ä¸ªå‡½æ•°çš„å‚æ•°ä»¥åŠè¿”å›å€¼éƒ½æŒ‡å®šç±»å‹ï¼š

```dart
int fibonacci(int n) {
  if (n == 0 || n == 1) {
    return n;
  }

  return fibonacci(n - 1) + fibonacci(n - 2);
}
```

&emsp;=> (èƒ–ç®­å¤´) ç®€å†™è¯­æ³•ç”¨äºä»…åŒ…å«ä¸€æ¡è¯­å¥çš„å‡½æ•°ã€‚è¯¥è¯­æ³•åœ¨å°†åŒ¿åå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’æ—¶éå¸¸æœ‰ç”¨ï¼š

```dart
void main(List<String> args) {
  var flybyObjects = ['Jupiter', 'Saturn', 'Uranus', 'Neptune'];
  flybyObjects.where((element) => element.contains('turn')).forEach(print);
}
```

&emsp;ä¸Šé¢çš„ç¤ºä¾‹å±•ç¤ºäº†åŒ¿åå‡½æ•°ï¼šä¼ å…¥ `where()` å‡½æ•°çš„å‚æ•°å³æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œè¿˜å±•ç¤ºäº†å°†å‡½æ•°ä½œä¸ºå‚æ•°ä½¿ç”¨çš„æ–¹å¼ï¼šå°†é¡¶å±‚å‡½æ•° `print()` ä½œä¸ºå‚æ•°ä¼ ç»™äº† `forEach()` å‡½æ•°ã€‚

## æ³¨é‡Š

&emsp;Dart é€šå¸¸ä½¿ç”¨åŒæ–œæ  `//` ä½œä¸ºæ³¨é‡Šçš„å¼€å§‹ã€‚

```dart
/// è¿™æ˜¯ä¸€ä¸ªæ–‡æ¡£æ³¨é‡Šã€‚
/// æ–‡æ¡£æ³¨é‡Šç”¨äºä¸ºåº“ã€ç±»ä»¥åŠç±»çš„æˆå‘˜æ·»åŠ æ³¨é‡Šã€‚
/// åƒ IDE å’Œ dartdoc è¿™æ ·çš„å·¥å…·å¯ä»¥ä¸“é—¨å¤„ç†æ–‡æ¡£æ³¨é‡Šã€‚

/* ä¹Ÿå¯ä»¥åƒè¿™æ ·ä½¿ç”¨å•æ–œæ å’Œæ˜Ÿå·çš„æ³¨é‡Šæ–¹å¼ */
```

## å¯¼å…¥ï¼ˆ Import ï¼‰

&emsp;ä½¿ç”¨ `import` å…³é”®å­—æ¥è®¿é—®åœ¨å…¶å®ƒåº“ä¸­å®šä¹‰çš„ APIã€‚

```dart
// Importing core libraries
import 'dart:math';

// Importing libraries from external packages
import 'package:test/test.dart';

// Importing files
import 'path/to/my_other_file.dart';
```

## ç±»ï¼ˆ Class ï¼‰

&emsp;ä¸‹é¢çš„ç¤ºä¾‹å±•ç¤ºäº†ä¸€ä¸ªåŒ…å«ä¸‰ä¸ªå±æ€§ã€ä¸¤ä¸ªæ„é€ å‡½æ•°ä»¥åŠä¸€ä¸ªæ–¹æ³•çš„ç±»ã€‚å…¶ä¸­ä¸€ä¸ªå±æ€§ä¸èƒ½ç›´æ¥èµ‹å€¼ï¼Œå› æ­¤å®ƒè¢«å®šä¹‰ä¸ºä¸€ä¸ª getter æ–¹æ³•ï¼ˆè€Œä¸æ˜¯å˜é‡ï¼‰ã€‚

```dart
class Spacecraft {
  String name;
  DateTime? launchDate;

  // Read-only non-final property
  int? get launchYear => launchDate?.year;

  // Constructorï¼Œwith syntactic sugar for assignment to members.
  Spacecraft(this.name, this.launchDate) {
    // Initialization code goes here.
  }

  // Named constructor that forwards to the default one.
  Spacecraft.unlaunched(String name) : this(name, null);

  // Method.
  void describe() {
    print('Spacecraft: $name');
    // Type promotion doesn't work on getters.
    var launchDate = this.launchDate;
    if (launchDate != null) {
      int years = DateTime.now().difference(launchDate).inDays ~/ 365;
      print('Launched: $launchYear ($years years ago)');
    } else {
      print('Unlaunched');
    }
  }
}
```

&emsp;å¯ä»¥åƒä¸‹é¢è¿™æ ·ä½¿ç”¨ Spacecraft ç±»ï¼š

```dart
var voyager = Spacecraft('Voyager I', DateTime(1977, 9, 5));
voyager.describe();

var voyager3 = Spacecraft.unlaunched('Voyager III');
voyager3.describe();
```

&emsp;æ‰“å°å¦‚ä¸‹ï¼š

```dart
Spacecraft: Voyager I
Launched: 1977 (44 years ago)
Spacecraft: Voyager III
Unlaunched
```

## æ‰©å±•ç±»ï¼ˆç»§æ‰¿ï¼‰

&emsp;Dart æ”¯æŒå•ç»§æ‰¿ã€‚

```dart
class Orbiter extends Spacecraft {
  double altitude;

  Orbiter(String name, DateTime launchDate, this.altitude)
      : super(name, launchDate);
}
```

## Mixins

&emsp;Mixin æ˜¯ä¸€ç§åœ¨å¤šä¸ªç±»å±‚æ¬¡ç»“æ„ä¸­é‡ç”¨ä»£ç çš„æ–¹æ³•ã€‚ä¸‹é¢çš„æ˜¯å£°æ˜ä¸€ä¸ª Mixin çš„åšæ³•ï¼š

```dart
mixin Piloted {
  int astronauts = 1;

  void describeCrew() {
    print('Number of astronauts: $astronauts');
  }
}
```

&emsp;ç°åœ¨åªéœ€ä½¿ç”¨ Mixin çš„æ–¹å¼ç»§æ‰¿è¿™ä¸ªç±»å°±å¯å°†è¯¥ç±»ä¸­çš„åŠŸèƒ½æ·»åŠ ç»™å…¶å®ƒç±»ã€‚

```dart
class PilotedCraft extends Spacecraft with Piloted {
  PilotedCraft(String name, DateTime? launchDate) : super(name, launchDate);
  //...
}
```

&emsp;è‡ªæ­¤ï¼ŒPilotedCraft ç±»ä¸­å°±åŒ…å«äº† astronauts å­—æ®µä»¥åŠ describeCrew() æ–¹æ³•ã€‚

## æ¥å£å’ŒæŠ½è±¡ç±»

&emsp;Dart æ²¡æœ‰ interface å…³é”®å­—ã€‚ç›¸åï¼Œæ‰€æœ‰çš„ç±»éƒ½éšå¼å®šä¹‰äº†ä¸€ä¸ªæ¥å£ã€‚å› æ­¤ï¼Œä»»æ„ç±»éƒ½å¯ä»¥ä½œä¸ºæ¥å£è¢«å®ç°ã€‚

```dart
class MockSpaceship implements Spacecraft {
  @override
  DateTime? launchDate;

  @override
  late String name;

  @override
  void describe() {
    // TODO: implement describe
  }

  @override
  // TODO: implement launchYear
  int? get launchYear => throw UnimplementedError();
  // ...
}
```

&emsp;å¯ä»¥åˆ›å»ºä¸€ä¸ªè¢«ä»»æ„å…·ä½“ç±»æ‰©å±•ï¼ˆæˆ–å®ç°ï¼‰çš„æŠ½è±¡ç±»ã€‚æŠ½è±¡ç±»å¯ä»¥åŒ…å«æŠ½è±¡æ–¹æ³•ï¼ˆä¸å«æ–¹æ³•ä½“çš„æ–¹æ³•ï¼‰ã€‚

```dart
abstract class Describable {
  void describe();

  void describeWithEmphasis() {
    print('======');
    describe();
    print('======');
  }
}
```

&emsp;ä»»æ„ä¸€ä¸ªæ‰©å±•äº† `Describable` çš„ç±»éƒ½æ‹¥æœ‰ `describeWithEmphasis()` æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•åˆä¼šå»è°ƒç”¨å®ç°ç±»ä¸­å®ç°çš„ `describe()` æ–¹æ³•ã€‚

## å¼‚æ­¥

&emsp;ä½¿ç”¨ async å’Œ await å…³é”®å­—å¯ä»¥é¿å…å›è°ƒåœ°ç‹±ï¼ˆCallback Hellï¼‰å¹¶ä½¿ä»£ç æ›´å…·å¯è¯»æ€§ã€‚

```dart
const oneSecond = Duration(seconds: 1);
// ...
Future<void> printWithDelay(String message) async {
  await Future.delayed(oneSecond);
  print(message);
}
```

&emsp;ä¸Šé¢çš„æ–¹æ³•ç›¸å½“äºï¼š

```dart
Future<void> printWithDelay(String message) {
  return Future.delayed(oneSecond).then((_) => print(message));
}
```

&emsp;å¦‚ä¸‹ä¸€ä¸ªç¤ºä¾‹æ‰€ç¤ºï¼Œasync å’Œ await å…³é”®å­—æœ‰åŠ©äºä½¿å¼‚æ­¥ä»£ç å˜å¾—æ˜“äºé˜…è¯»ã€‚

```dart
Future<void> createDescriptions(Iterable<String> objects) async {
  for (final object in objects) {
    try {
      var file = File('$object.txt');
      if (await file.exists()) {
        var modified = await file.lastModified();
        print('File for $object already exists. It was modified on $modified.');
        continue;
      }
      await file.create();
      await file.writeAsString('Start describing $object in this file.');
    } on IOException catch (e) {
      print('Cannot create description for $object: $e');
    }
  }
}
```

&emsp;ä¹Ÿå¯ä»¥ä½¿ç”¨ `async*` å…³é”®å­—ï¼Œå¯ä»¥æä¾›ä¸€ä¸ªå¯è¯»æ€§æ›´å¥½çš„æ–¹å¼å»ç”Ÿæˆ Streamã€‚

```dart
Stream<String> report(Spacecraft craft, Iterable<String> objects) async* {
  for (final object in objects) {
    await Future.delayed(oneSecond);
    yield '${craft.name} files by $object';
  }
}
```

## å¼‚å¸¸

&emsp;ä½¿ç”¨ throw å…³é”®å­—æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼š

```dart
if (astronauts == 0) {
  throw StateError('No astronauts.');
}
```

&emsp;ä½¿ç”¨ try è¯­å¥é…åˆ on æˆ– catchï¼ˆä¸¤è€…ä¹Ÿå¯åŒæ—¶ä½¿ç”¨ï¼‰å…³é”®å­—æ¥æ•è·ä¸€ä¸ªå¼‚å¸¸:

```dart
try {
  for (final object in flybyObjects) {
    var description = await File('$object.txt').readAsString();
    print(description);
  }
} on IOException catch (e) {
  print('Could not describe object: $e');
} finally {
  flybyObjects.clear();
}
```

&emsp;æ³¨æ„ä¸Šè¿°ä»£ç æ˜¯å¼‚æ­¥çš„ï¼›åŒæ­¥ä»£ç ä»¥åŠå¼‚æ­¥å‡½æ•°ä¸­çš„ä»£ç éƒ½å¯ä»¥ä½¿ç”¨ try æ•è·å¼‚å¸¸ã€‚




































&emsp;å¯ä»¥ä½¿ç”¨ `+` è¿ç®—ç¬¦æˆ– **å¹¶åˆ—æ”¾ç½®å¤šä¸ªå­—ç¬¦ä¸²æ¥è¿æ¥å­—ç¬¦ä¸²**ï¼šè¿™é‡Œå’Œæˆ‘ä»¬å­¦çš„å…¶ä»–è¯­è¨€çš„å­—ç¬¦ä¸²æ‹¼æ¥ä¸åŒï¼ŒDart åªè¦æŠŠå­—ç¬¦ä¸²å¹¶åˆ—æ”¾ç½®ä¹Ÿèƒ½è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥ã€‚

```c++
  var s1 = 'String '
      'concatenation'
      " works even over line breaks.";

  var s2 = 'String ' 'concatenation' " works even over line breaks.";
```

&emsp;ä½¿ç”¨ **ä¸‰ä¸ªå•å¼•å·** æˆ–è€… **ä¸‰ä¸ªåŒå¼•å·** èƒ½åˆ›å»ºå¤šè¡Œå­—ç¬¦ä¸²ï¼š

```c++
  var s3 = '''
You can create
multi-line strings like this one.
''';

  var s4 = """This is also a
multi-line string.""";
```

&emsp;åœ¨å­—ç¬¦ä¸²å‰åŠ ä¸Š `r` ä½œä¸ºå‰ç¼€åˆ›å»º "raw" å­—ç¬¦ä¸²ï¼Œä¼šä¿ç•™å­—ç¬¦ä¸²ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ `\n` è¢«ä¿ç•™ä¸º `\n` å­—ç¬¦ï¼Œè€Œä¸æ˜¯ä½œæ¢è¡Œä½¿ç”¨ï¼ˆå³ä¸ä¼šè¢«åšä»»ä½•å¤„ç†ï¼ˆæ¯”å¦‚è½¬ä¹‰ï¼‰çš„å­—ç¬¦ä¸²ï¼‰ï¼š

```c++
var s5 = r'In a raw string, not even \n gets special treatment.';
```

&emsp;ä½¿ç”¨ VS Code å®‰è£… Dart æ‰©å±•ï¼Œç„¶åæ–°å»ºä¸€ä¸ª .dart æ–‡ä»¶ç›´æ¥å¼€å§‹ Dart ç¼–ç¨‹ï¼ 

&emsp;æ¯ä¸ªåº”ç”¨éƒ½æœ‰ä¸€ä¸ª `main()` å‡½æ•°ã€‚å¯ä»¥ä½¿ç”¨é¡¶å±‚ï¼ˆtop-levelï¼‰å‡½æ•° `print()` æ¥å°†ä¸€æ®µæ–‡æœ¬è¾“å‡ºæ˜¾ç¤ºåˆ°æ§åˆ¶å°ï¼š

```dart
void main() {
  print('Hello, World!');
}
```

&emsp;è™½ç„¶ Dart æ˜¯ä»£ç ç±»å‹å®‰å…¨çš„è¯­è¨€ï¼Œä½†æ˜¯ç”±äºå…¶æ”¯æŒç±»å‹æ¨æ–­ï¼Œå› æ­¤å¤§å¤šæ•°å˜é‡ä¸éœ€è¦æ˜¾å¼åœ°æŒ‡å®šç±»å‹ï¼š

```dart
  var name = 'Voyager I';
  var year = 1977;
  var antennaDiameter = 3.7;
  var flybyObjects = ['Jupiter', 'Saturn', 'Uranus', 'Neptune'];
  var image = {
    'tags': ['saturn'],
    'url': '//path/to/saturn.jpg'
  };
```

&emsp;Mixin æ˜¯ä¸€ç§åœ¨å¤šä¸ªç±»å±‚æ¬¡ç»“æ„ä¸­é‡ç”¨ä»£ç çš„æ–¹æ³•ã€‚ä¸‹é¢çš„æ˜¯å£°æ˜ä¸€ä¸ª Mixin çš„åšæ³•ï¼š

```c++
mixin Piloted {
  int astronauts = 1;

  void describeCrew() {
    print('Number of astronauts: $astronauts');
  }
}

class Orbiter extends Spacecraft with Piloted {
    // 
}
```



## å‚è€ƒé“¾æ¥
**å‚è€ƒé“¾æ¥:ğŸ”—**
+ [Dart ç¼–ç¨‹è¯­è¨€æ¦‚è§ˆ](https://dart.cn/samples)
+ [Dart å¼€å‘è¯­è¨€æ¦‚è§ˆ](https://dart.cn/guides/language/language-tour)

